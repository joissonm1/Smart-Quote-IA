let isDark = false;

const themeToggle = document.getElementById("themeToggle");
const body = document.body;
const feedback = document.getElementById("feedback");
const form = document.getElementById("budgetForm");

function updateTheme() {
  body.classList.toggle("dark", isDark);
  themeToggle.textContent = isDark ? "üåô" : "üåû";
}

themeToggle.addEventListener("click", () => {
  isDark = !isDark;
  updateTheme();
});

form.addEventListener("submit", async (e) => {
  e.preventDefault();
  if (!form.checkValidity()) {
    feedback.textContent = "Por favor, preencha todos os campos obrigat√≥rios.";
    feedback.style.color = "red";
    return;
  }

  const formData = new FormData(form);
  const data = {
    nome: formData.get("nome"),
    email: formData.get("email"),
    descricao: formData.get("descricao"),
    anexos: [...formData.getAll("anexos")].map(file => file.name)
  };

  try {
    const res = await fetch("http://localhost:3000/forms", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify(data)
    });

    if (res.ok) {
      feedback.textContent = "Formul√°rio enviado com sucesso!";
      feedback.style.color = "green";
      form.reset();
    } else {
      throw new Error("Erro ao enviar");
    }
  } catch (err) {
    feedback.textContent = "Erro ao enviar o formul√°rio.";
    feedback.style.color = "red";
  }
});

updateTheme(); // Inicializa tema
